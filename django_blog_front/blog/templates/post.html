{% extends "base.html" %}
{% load static %}
{% block header %}

{% include "includes/header.html" with title=post.title created_at=post.created_at text_user_field="Publicado por " user=post.user.username bg_image=post.miniature_url description=post.description %}

{% endblock%}

{% block content %}
<div class="col-md-10 col-lg-8 col-xl-10" id="post-list">
  <article>
    <div class="container">
      <div class="row">
        <div class="col-md-10 mx-auto">
          {{ post.content | safe }}
          {% if request.session.token and post.user.email == request.session.email %}
          <br>
          <a type="button" class="btn  btn-warning" href="{% url 'edit_post' post.slug %}" >Editar</a>
          <form action="{% url 'delete_post' post.slug %}" method="post" style="display:inline;">
            {% csrf_token %}
            <button type="submit" class="btn btn-danger" onclick="return confirm('Eliminar este post?');">
              Eliminar
            </button>
          </form>  
          {% endif %}
          <br>
          <h3>Comentarios</h3>
         {% for comment in comments %}
          <div class="mb-3 border-bottom pb-2">
            <strong>{{ comment.user.username }}</strong>
            <small class="text-muted"> — {{ comment.created_at|date:"d/m/Y H:i" }}</small>
            <p>{{ comment.content }}</p>
          </div>
          {% empty %}
          <p>No hay comentarios aún.</p>
          {% endfor %}
          <br>
          <form id="comment-form">
            <textarea id="comment-content" class="form-control mb-2" rows="3" placeholder="Comentar..." required></textarea>
            <button type="submit" class="btn btn-primary">Enviar</button>
          </form>
        </div>
      </div>
    </div>
  </article>
</div>
{% endblock %}